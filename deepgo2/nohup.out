enter load_data
features_length:  5120
features_column:  protgpt2
Terms 2829
data_root:  data
ont:  cc
terms_file:  data/cc/terms.pkl
features_length:  5120
features_column:  protgpt2
test_data_file:  test_gpt_data.pkl
DeepGOModel(
  (go_embed): Embedding(45250, 2560)
  (go_norm): BatchNorm1d(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (go_rad): Embedding(45250, 1)
  (rel_embed): Embedding(9, 2560)
  (net): Sequential(
    (0): MLPBlock(
      (linear): Linear(in_features=5120, out_features=2560, bias=True)
      (activation): ReLU()
      (layer_norm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (1): Residual(
      (fn): MLPBlock(
        (linear): Linear(in_features=2560, out_features=2560, bias=True)
        (activation): ReLU()
        (layer_norm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
Training the model

Validation

Epoch 0: Loss - 0.029492368979845196, EL Loss: 2.7747802734375, Valid loss - 0.024735901159820734, AUC - 0.8929921694323105
EL Loss 2.7747802734375
Saving model

Validation

Epoch 1: Loss - 0.01944036420106634, EL Loss: 1.0865994691848755, Valid loss - 0.013785320932022583, AUC - 0.9695875502526514
EL Loss 1.0865994691848755
Saving model

Validation

Epoch 2: Loss - 0.014964021950700871, EL Loss: 0.6145768761634827, Valid loss - 0.0133917309274828, AUC - 0.9728330362601935
EL Loss 0.6145768761634827
Saving model

Validation

Epoch 3: Loss - 0.014345517405837943, EL Loss: 0.36491715908050537, Valid loss - 0.013374706477294733, AUC - 0.9736614865272063
EL Loss 0.36491715908050537
Saving model

Validation

Epoch 4: Loss - 0.014067804075073747, EL Loss: 0.20515981316566467, Valid loss - 0.013324151333007548, AUC - 0.9733956211827498
EL Loss 0.20515981316566467
Saving model

Validation

Epoch 5: Loss - 0.01374120261805894, EL Loss: 0.18072162568569183, Valid loss - 0.013237900744525738, AUC - 0.9745658258012699
EL Loss 0.18072162568569183
Saving model

Validation

Epoch 6: Loss - 0.013633888098411262, EL Loss: 0.16111990809440613, Valid loss - 0.01332587364739106, AUC - 0.974960742358944
EL Loss 0.16111990809440613

Validation

Epoch 7: Loss - 0.01355711036938539, EL Loss: 0.1363823413848877, Valid loss - 0.013231342060514439, AUC - 0.9750290392870209
EL Loss 0.1363823413848877
Saving model

Validation

Epoch 8: Loss - 0.013438603551714385, EL Loss: 0.10880040377378464, Valid loss - 0.013138806688840743, AUC - 0.9753945443710313
EL Loss 0.10880040377378464
Saving model

Validation

Epoch 9: Loss - 0.013185297589436894, EL Loss: 0.08125234395265579, Valid loss - 0.012845146860697387, AUC - 0.976533245121596
EL Loss 0.08125234395265579
Saving model

Validation

Epoch 10: Loss - 0.012739834977930348, EL Loss: 0.05560258775949478, Valid loss - 0.012587729335567097, AUC - 0.9787993036391346
EL Loss 0.05560258775949478
Saving model

Validation

Epoch 11: Loss - 0.01221975211063347, EL Loss: 0.03275242820382118, Valid loss - 0.012422028423091511, AUC - 0.9804053672539381
EL Loss 0.03275242820382118
Saving model

Validation

Epoch 12: Loss - 0.01165479637480034, EL Loss: 0.01320783980190754, Valid loss - 0.0121559821828096, AUC - 0.9816128496700878
EL Loss 0.01320783980190754
Saving model

Validation

Epoch 13: Loss - 0.011036915417207638, EL Loss: 0.0019339764257892966, Valid loss - 0.012155642606501963, AUC - 0.9824020413519305
EL Loss 0.0019339764257892966
Saving model

Validation

Epoch 14: Loss - 0.010482906012012709, EL Loss: 0.0013951874570921063, Valid loss - 0.012228977889466433, AUC - 0.9823340354126706
EL Loss 0.0013951874570921063

Validation

Epoch 15: Loss - 0.010014546089554311, EL Loss: 0.0012388770701363683, Valid loss - 0.012120155226669194, AUC - 0.982866925179254
EL Loss 0.0012388770701363683
Saving model

Validation

Epoch 16: Loss - 0.009601138546713628, EL Loss: 0.0011036936193704605, Valid loss - 0.012254720645738237, AUC - 0.9827157973485153
EL Loss 0.0011036936193704605

Validation

Epoch 17: Loss - 0.009177882002073933, EL Loss: 0.0009866608306765556, Valid loss - 0.012383910436413171, AUC - 0.9822948132870368
EL Loss 0.0009866608306765556

Validation

Epoch 18: Loss - 0.008804191980413056, EL Loss: 0.0008857326465658844, Valid loss - 0.012566981848651244, AUC - 0.9817827441243602
EL Loss 0.0008857326465658844

Validation

Epoch 19: Loss - 0.008392562695173017, EL Loss: 0.0007985341944731772, Valid loss - 0.012870026499400904, AUC - 0.9809189246217334
EL Loss 0.0007985341944731772

Validation

Epoch 20: Loss - 0.007762775724338347, EL Loss: 0.0007894988521002233, Valid loss - 0.01295210124441871, AUC - 0.9807003208838079
EL Loss 0.0007894988521002233

Validation

Epoch 21: Loss - 0.007655574724181365, EL Loss: 0.0007809408125467598, Valid loss - 0.013033982837733663, AUC - 0.9804240522572119
EL Loss 0.0007809408125467598

Validation

Epoch 22: Loss - 0.007580339505114931, EL Loss: 0.0007726165349595249, Valid loss - 0.013126480646063516, AUC - 0.9800204207818924
EL Loss 0.0007726165349595249

Validation

Epoch 23: Loss - 0.007520438595251603, EL Loss: 0.000764557218644768, Valid loss - 0.013152028778912845, AUC - 0.9800310995516147
EL Loss 0.000764557218644768

Validation

Epoch 24: Loss - 0.007463722288031766, EL Loss: 0.0007564877159893513, Valid loss - 0.013205029990202115, AUC - 0.9799065002616666
EL Loss 0.0007564877159893513

Validation

Epoch 25: Loss - 0.007413745238326638, EL Loss: 0.0007485314854420722, Valid loss - 0.013250277055726374, AUC - 0.979877550929177
EL Loss 0.0007485314854420722

Validation

Epoch 26: Loss - 0.007349515118469505, EL Loss: 0.0007403995841741562, Valid loss - 0.013329490674314675, AUC - 0.9796175317749028
EL Loss 0.0007403995841741562

Validation

Epoch 27: Loss - 0.007293444925876843, EL Loss: 0.0007326571503654122, Valid loss - 0.013384228319297602, AUC - 0.9795172724133819
EL Loss 0.0007326571503654122

Validation

Epoch 28: Loss - 0.007245630795130803, EL Loss: 0.0007251072092913091, Valid loss - 0.013365823787027671, AUC - 0.979584825943847
EL Loss 0.0007251072092913091

Validation

Epoch 29: Loss - 0.0071826159788046925, EL Loss: 0.0007176163489930332, Valid loss - 0.013452325418683481, AUC - 0.9793776787734643
EL Loss 0.0007176163489930332

Validation

Epoch 30: Loss - 0.0071284542550115884, EL Loss: 0.0007101527880877256, Valid loss - 0.01349631051912352, AUC - 0.9792587456604492
EL Loss 0.0007101527880877256

Validation

Epoch 31: Loss - 0.007069897508203708, EL Loss: 0.000702840625308454, Valid loss - 0.013580286955851832, AUC - 0.978857349115639
EL Loss 0.000702840625308454

Validation

Epoch 32: Loss - 0.007024503271498939, EL Loss: 0.0006956440047360957, Valid loss - 0.013666105295680924, AUC - 0.9787773933359175
EL Loss 0.0006956440047360957

Validation

Epoch 33: Loss - 0.006963596648016723, EL Loss: 0.0006887717172503471, Valid loss - 0.013737050482980262, AUC - 0.9785295038117745
EL Loss 0.0006887717172503471

Validation

Epoch 34: Loss - 0.006909180890943389, EL Loss: 0.0006819333648309112, Valid loss - 0.013730426134978548, AUC - 0.9788388072387
EL Loss 0.0006819333648309112

Validation

Epoch 35: Loss - 0.0068530790466122034, EL Loss: 0.0006751182954758406, Valid loss - 0.013784561041788554, AUC - 0.9785804604138426
EL Loss 0.0006751182954758406

Validation

Epoch 36: Loss - 0.00680147005319172, EL Loss: 0.0006684593390673399, Valid loss - 0.01388022430057143, AUC - 0.9781708789180603
EL Loss 0.0006684593390673399

Validation

Epoch 37: Loss - 0.006748695281037892, EL Loss: 0.000661781697999686, Valid loss - 0.01390663406777161, AUC - 0.9780423826480962
EL Loss 0.000661781697999686

Validation

Epoch 38: Loss - 0.006689127343634027, EL Loss: 0.0006550969555974007, Valid loss - 0.014015566431169893, AUC - 0.9779934839701531
EL Loss 0.0006550969555974007

Validation

Epoch 39: Loss - 0.006639993165167239, EL Loss: 0.0006484324112534523, Valid loss - 0.014050271718498365, AUC - 0.9777170106274998
EL Loss 0.0006484324112534523

Validation

Epoch 40: Loss - 0.0065865722537471975, EL Loss: 0.0006417729891836643, Valid loss - 0.014103336662146044, AUC - 0.9776147408189461
EL Loss 0.0006417729891836643

Validation

Epoch 41: Loss - 0.00653147540784134, EL Loss: 0.0006351193878799677, Valid loss - 0.014152575709661584, AUC - 0.9776890199699594
EL Loss 0.0006351193878799677

Validation

Epoch 42: Loss - 0.00647157111019293, EL Loss: 0.0006286893622018397, Valid loss - 0.01423886714986077, AUC - 0.9775857293005327
EL Loss 0.0006286893622018397

Validation

Epoch 43: Loss - 0.006411590700570907, EL Loss: 0.0006219166098162532, Valid loss - 0.014331166701460327, AUC - 0.9771269350017318
EL Loss 0.0006219166098162532

Validation

Epoch 44: Loss - 0.006362785323455517, EL Loss: 0.0006154446164146066, Valid loss - 0.01437500765386187, AUC - 0.9768905383890764
EL Loss 0.0006154446164146066

Validation

Epoch 45: Loss - 0.006301452544986122, EL Loss: 0.0006090274546295404, Valid loss - 0.014465989269040249, AUC - 0.9767605748099336
EL Loss 0.0006090274546295404

Validation

Epoch 46: Loss - 0.006256029001220172, EL Loss: 0.0006026758928783238, Valid loss - 0.014552381062121303, AUC - 0.9765434935221999
EL Loss 0.0006026758928783238

Validation

Epoch 47: Loss - 0.006195592459169513, EL Loss: 0.0005962853319942951, Valid loss - 0.014574847850994563, AUC - 0.9766650729872007
EL Loss 0.0005962853319942951

Validation

Epoch 48: Loss - 0.00614309011441285, EL Loss: 0.0005900256801396608, Valid loss - 0.014661908678618479, AUC - 0.9764556234866659
EL Loss 0.0005900256801396608

Validation

Epoch 49: Loss - 0.00608858183278988, EL Loss: 0.0005837911739945412, Valid loss - 0.014764953772594899, AUC - 0.9761422280656289
EL Loss 0.0005837911739945412

Validation

Epoch 50: Loss - 0.006030440603353782, EL Loss: 0.000577762140892446, Valid loss - 0.014840622145084687, AUC - 0.975978582865549
EL Loss 0.000577762140892446

Validation

Epoch 51: Loss - 0.00597276032054982, EL Loss: 0.0005718956817872822, Valid loss - 0.01489492142458021, AUC - 0.9758099571002501
EL Loss 0.0005718956817872822

Validation

Epoch 52: Loss - 0.0059249067539481485, EL Loss: 0.000565944763366133, Valid loss - 0.015035856929090288, AUC - 0.9757430490641502
EL Loss 0.000565944763366133

Validation

Epoch 53: Loss - 0.00586504693522081, EL Loss: 0.0005600637523457408, Valid loss - 0.015065555288283914, AUC - 0.9757851623751784
EL Loss 0.0005600637523457408

Validation

Epoch 54: Loss - 0.005815294734929921, EL Loss: 0.0005542846047319472, Valid loss - 0.01521825987017817, AUC - 0.975531899199048
EL Loss 0.0005542846047319472

Validation

Epoch 55: Loss - 0.005748868667069473, EL Loss: 0.0005485502770170569, Valid loss - 0.015231517971389823, AUC - 0.9752941215727908
EL Loss 0.0005485502770170569

Validation

Epoch 56: Loss - 0.005694342674442768, EL Loss: 0.0005429151351563632, Valid loss - 0.015303899924972175, AUC - 0.975047225110115
EL Loss 0.0005429151351563632

Validation

Epoch 57: Loss - 0.00564738049400727, EL Loss: 0.0005373195745050907, Valid loss - 0.015410667055366952, AUC - 0.9749216933659063
EL Loss 0.0005373195745050907

Validation

Epoch 58: Loss - 0.005581825541164356, EL Loss: 0.000531841185875237, Valid loss - 0.015561470646917083, AUC - 0.9748351278066345
EL Loss 0.000531841185875237

Validation

Epoch 59: Loss - 0.005528992561184251, EL Loss: 0.0005264745559543371, Valid loss - 0.015530561349918077, AUC - 0.9748399603253389
EL Loss 0.0005264745559543371

Validation

Epoch 60: Loss - 0.005474573814849878, EL Loss: 0.0005211353418417275, Valid loss - 0.015617185019324591, AUC - 0.9745539543339015
EL Loss 0.0005211353418417275

Validation

Epoch 61: Loss - 0.005413758375983558, EL Loss: 0.0005158087005838752, Valid loss - 0.015807913650793058, AUC - 0.9741321124558736
EL Loss 0.0005158087005838752

Validation

Epoch 62: Loss - 0.005361716408515349, EL Loss: 0.0005105002201162279, Valid loss - 0.015867433729179113, AUC - 0.9742023463963234
EL Loss 0.0005105002201162279

Validation

Epoch 63: Loss - 0.005306678441642857, EL Loss: 0.0005053208442404866, Valid loss - 0.01596309320518264, AUC - 0.9740184528026113
EL Loss 0.0005053208442404866

Validation

Epoch 64: Loss - 0.005250254353913161, EL Loss: 0.0005001494428142905, Valid loss - 0.016090028114432907, AUC - 0.9736049351828521
EL Loss 0.0005001494428142905

Validation

Epoch 65: Loss - 0.005193377591488322, EL Loss: 0.0004949797294102609, Valid loss - 0.016150643796096615, AUC - 0.9737512108050347
EL Loss 0.0004949797294102609

Validation

Epoch 66: Loss - 0.005128169459898014, EL Loss: 0.000489872123580426, Valid loss - 0.016259301281361667, AUC - 0.9735699967543817
EL Loss 0.000489872123580426

Validation

Epoch 67: Loss - 0.005070073342060575, EL Loss: 0.0004846946394536644, Valid loss - 0.016437147789991197, AUC - 0.973119861812438
EL Loss 0.0004846946394536644

Validation

Epoch 68: Loss - 0.005021202204509543, EL Loss: 0.0004795815621037036, Valid loss - 0.01647529042797324, AUC - 0.9729764151380134
EL Loss 0.0004795815621037036

Validation

Epoch 69: Loss - 0.004963370179459823, EL Loss: 0.0004744517500512302, Valid loss - 0.01655397560723402, AUC - 0.972955051764311
EL Loss 0.0004744517500512302

Validation

Epoch 70: Loss - 0.004921537724426757, EL Loss: 0.0004694391100201756, Valid loss - 0.016648709256615903, AUC - 0.9729748699241874
EL Loss 0.0004694391100201756

Validation

Epoch 71: Loss - 0.0048591788465935015, EL Loss: 0.00046431997907347977, Valid loss - 0.016786815989532588, AUC - 0.972814609009036
EL Loss 0.00046431997907347977

Validation

Epoch 72: Loss - 0.004798664528359289, EL Loss: 0.0004595197387970984, Valid loss - 0.016787681234195644, AUC - 0.9728115589968346
EL Loss 0.0004595197387970984

Validation

Epoch 73: Loss - 0.004746047454980065, EL Loss: 0.0004547514545265585, Valid loss - 0.016903254180502744, AUC - 0.9724848200874356
EL Loss 0.0004547514545265585

Validation

Epoch 74: Loss - 0.004683710933353392, EL Loss: 0.00045020371908321977, Valid loss - 0.017113828077268453, AUC - 0.9723351748998064
EL Loss 0.00045020371908321977

Validation

Epoch 75: Loss - 0.0046326271302942505, EL Loss: 0.0004456817405298352, Valid loss - 0.017330720284838737, AUC - 0.9718815172295181
EL Loss 0.0004456817405298352

Validation

Epoch 76: Loss - 0.0045823387849436995, EL Loss: 0.0004412886337377131, Valid loss - 0.01743618964597031, AUC - 0.9718042518583202
EL Loss 0.0004412886337377131

Validation

Epoch 77: Loss - 0.004526879150778934, EL Loss: 0.00043696005013771355, Valid loss - 0.017454474325073355, AUC - 0.9719267040449046
EL Loss 0.00043696005013771355

Validation

Epoch 78: Loss - 0.004478923248660232, EL Loss: 0.0004326957860030234, Valid loss - 0.01753586131711433, AUC - 0.9720179623440964
EL Loss 0.0004326957860030234

Validation

Epoch 79: Loss - 0.004423917853934902, EL Loss: 0.0004285163595341146, Valid loss - 0.0177144934595735, AUC - 0.9716093790520178
EL Loss 0.0004285163595341146

Validation

Epoch 80: Loss - 0.004367992088274067, EL Loss: 0.0004244925803504884, Valid loss - 0.017814427200290892, AUC - 0.9716902404052307
EL Loss 0.0004244925803504884

Validation

Epoch 81: Loss - 0.004316130070947111, EL Loss: 0.00042057002428919077, Valid loss - 0.01795116813140519, AUC - 0.9711458435552113
EL Loss 0.00042057002428919077

Validation

Epoch 82: Loss - 0.004258257631921548, EL Loss: 0.00041666586184874177, Valid loss - 0.017959126547254897, AUC - 0.9712240756728889
EL Loss 0.00041666586184874177

Validation

Epoch 83: Loss - 0.004206806742083493, EL Loss: 0.00041277363197878003, Valid loss - 0.018239387219058878, AUC - 0.9706011779400837
EL Loss 0.00041277363197878003

Validation

Epoch 84: Loss - 0.00416509365674177, EL Loss: 0.00040888614603318274, Valid loss - 0.0181848946613846, AUC - 0.970993287329597
EL Loss 0.00040888614603318274

Validation

Epoch 85: Loss - 0.004108971247577839, EL Loss: 0.0004049977578688413, Valid loss - 0.01823269640222008, AUC - 0.9709902384018136
EL Loss 0.0004049977578688413

Validation

Epoch 86: Loss - 0.004059884312730653, EL Loss: 0.0004012167046312243, Valid loss - 0.01853479342650116, AUC - 0.9704987700059873
EL Loss 0.0004012167046312243

Validation

Epoch 87: Loss - 0.0040053712514649805, EL Loss: 0.0003974022693000734, Valid loss - 0.01851290913965599, AUC - 0.9708384734463414
EL Loss 0.0003974022693000734

Validation

Epoch 88: Loss - 0.003960822262756251, EL Loss: 0.00039363265386782587, Valid loss - 0.018599790704931007, AUC - 0.9706875353368921
EL Loss 0.00039363265386782587

Validation

Epoch 89: Loss - 0.003906944510659246, EL Loss: 0.0003899172879755497, Valid loss - 0.01874015460733646, AUC - 0.9704245209144694
EL Loss 0.0003899172879755497

Validation

Epoch 90: Loss - 0.0038649319991567277, EL Loss: 0.00038623769069090486, Valid loss - 0.018926209689658365, AUC - 0.9701245978616527
EL Loss 0.00038623769069090486

Validation

Epoch 91: Loss - 0.0038042452012053796, EL Loss: 0.00038257951382547617, Valid loss - 0.01899319198442462, AUC - 0.9697754628864285
EL Loss 0.00038257951382547617

Validation

Epoch 92: Loss - 0.003762880864996987, EL Loss: 0.00037898257141932845, Valid loss - 0.019204225598110095, AUC - 0.9698148226448264
EL Loss 0.00037898257141932845

Validation

Epoch 93: Loss - 0.0037147238158054693, EL Loss: 0.00037555088056251407, Valid loss - 0.01928067278622845, AUC - 0.9696716272494761
EL Loss 0.00037555088056251407

Validation

Epoch 94: Loss - 0.0036632991328092016, EL Loss: 0.0003721128450706601, Valid loss - 0.019298759289085865, AUC - 0.9699585352615293
EL Loss 0.0003721128450706601

Validation

Epoch 95: Loss - 0.003627008091329613, EL Loss: 0.0003687041171360761, Valid loss - 0.019452912767452223, AUC - 0.9696595608790375
EL Loss 0.0003687041171360761
Loading the best model


Valid Loss - 0.012120155226669194, Test Loss - 0.011736122705042363, Test AUC - 0.9833267066721744
/mnt/data1/xyliu/DeepgoSE/deepgo2/deepgo/data.py:23: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)
  data[i, :] = th.FloatTensor(row.mlp_activation[27])
/mnt/data1/xyliu/.conda/envs/xyliuEnv/lib/python3.8/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
enter load_data
features_length:  5120
features_column:  protgpt2
Terms 2829
data_root:  data
ont:  cc
terms_file:  data/cc/terms.pkl
features_length:  5120
features_column:  protgpt2
test_data_file:  test_gpt_data.pkl
DeepGOModel(
  (go_embed): Embedding(45250, 2560)
  (go_norm): BatchNorm1d(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (go_rad): Embedding(45250, 1)
  (rel_embed): Embedding(9, 2560)
  (net): Sequential(
    (0): MLPBlock(
      (linear): Linear(in_features=5120, out_features=2560, bias=True)
      (activation): ReLU()
      (layer_norm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (1): Residual(
      (fn): MLPBlock(
        (linear): Linear(in_features=2560, out_features=2560, bias=True)
        (activation): ReLU()
        (layer_norm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
Training the model

Validation

Epoch 0: Loss - 0.029476055728578518, EL Loss: 2.764446258544922, Valid loss - 0.025793784194522433, AUC - 0.8623948486283541
EL Loss 2.764446258544922
Saving model

Validation

Epoch 1: Loss - 0.020741405007191297, EL Loss: 1.0876710414886475, Valid loss - 0.014419713126564468, AUC - 0.9657703080858211
EL Loss 1.0876710414886475
Saving model

Validation

Epoch 2: Loss - 0.014867423692935105, EL Loss: 0.5988953709602356, Valid loss - 0.01344254548534935, AUC - 0.9720330261241394
EL Loss 0.5988953709602356
Saving model

Validation

Epoch 3: Loss - 0.01440746584425638, EL Loss: 0.35699936747550964, Valid loss - 0.013303908404468753, AUC - 0.9735132725527184
EL Loss 0.35699936747550964
Saving model

Validation

Epoch 4: Loss - 0.014048522851556878, EL Loss: 0.20410017669200897, Valid loss - 0.013535561890881738, AUC - 0.9728275091411265
EL Loss 0.20410017669200897

Validation

Epoch 5: Loss - 0.013584974110761488, EL Loss: 0.1795121431350708, Valid loss - 0.013231740333139896, AUC - 0.974519140662073
EL Loss 0.1795121431350708
Saving model

Validation

Epoch 6: Loss - 0.01343284158462087, EL Loss: 0.16055653989315033, Valid loss - 0.013170398012907416, AUC - 0.9748351181229266
EL Loss 0.16055653989315033
Saving model

Validation

Epoch 7: Loss - 0.013257637243606785, EL Loss: 0.13637709617614746, Valid loss - 0.013135578713299316, AUC - 0.9747996275877236
EL Loss 0.13637709617614746
Saving model

Validation

Epoch 8: Loss - 0.012938156187870349, EL Loss: 0.10930011421442032, Valid loss - 0.013029635780387454, AUC - 0.9758604608889564
EL Loss 0.10930011421442032
Saving model

Validation

Epoch 9: Loss - 0.0125023626983007, EL Loss: 0.08229028433561325, Valid loss - 0.012790009482867189, AUC - 0.9773862051902995
EL Loss 0.08229028433561325
Saving model

Validation

Epoch 10: Loss - 0.012050941625520036, EL Loss: 0.05680616945028305, Valid loss - 0.012657922635107864, AUC - 0.9783278691717787
EL Loss 0.05680616945028305
Saving model

Validation

Epoch 11: Loss - 0.011563041460414586, EL Loss: 0.0339692085981369, Valid loss - 0.012434342427662125, AUC - 0.9796416737797115
EL Loss 0.0339692085981369
Saving model

Validation

Epoch 12: Loss - 0.011007353422345741, EL Loss: 0.014307776466012001, Valid loss - 0.012588873436605488, AUC - 0.9799899551467766
EL Loss 0.014307776466012001

Validation

Epoch 13: Loss - 0.010353652842406353, EL Loss: 0.002335797529667616, Valid loss - 0.01251017777134239, AUC - 0.9800644889700394
EL Loss 0.002335797529667616

Validation

Epoch 14: Loss - 0.009693206422525691, EL Loss: 0.0013422389747574925, Valid loss - 0.012745948186443175, AUC - 0.9792137930183322
EL Loss 0.0013422389747574925

Validation

Epoch 15: Loss - 0.009045969738508575, EL Loss: 0.0011969383340328932, Valid loss - 0.01285174364844958, AUC - 0.9790801486536238
EL Loss 0.0011969383340328932

Validation

Epoch 16: Loss - 0.008396072399839548, EL Loss: 0.0010726364562287927, Valid loss - 0.013243102434056776, AUC - 0.9784789371466468
EL Loss 0.0010726364562287927

Validation

Epoch 17: Loss - 0.007736786957883107, EL Loss: 0.000965539482422173, Valid loss - 0.013798051042321288, AUC - 0.9775645830581696
EL Loss 0.000965539482422173

Validation

Epoch 18: Loss - 0.0070664872013863214, EL Loss: 0.0008673250558786094, Valid loss - 0.014245008256424356, AUC - 0.9763704361790022
EL Loss 0.0008673250558786094

Validation

Epoch 19: Loss - 0.006403951432399812, EL Loss: 0.0007811507675796747, Valid loss - 0.01471253998439621, AUC - 0.9744953558000895
EL Loss 0.0007811507675796747

Validation

Epoch 20: Loss - 0.005416658566074065, EL Loss: 0.0007723111775703728, Valid loss - 0.015165946515346015, AUC - 0.9752076472460042
EL Loss 0.0007723111775703728

Validation

Epoch 21: Loss - 0.0052403754803394395, EL Loss: 0.0007641387637704611, Valid loss - 0.015325950677104202, AUC - 0.9746445441423939
EL Loss 0.0007641387637704611

Validation

Epoch 22: Loss - 0.005115152449765115, EL Loss: 0.0007562474347651005, Valid loss - 0.015459373271391715, AUC - 0.9741666179494289
EL Loss 0.0007562474347651005

Validation

Epoch 23: Loss - 0.005018538871147691, EL Loss: 0.0007485272944904864, Valid loss - 0.015572112617025406, AUC - 0.9739552520769498
EL Loss 0.0007485272944904864

Validation

Epoch 24: Loss - 0.004919441860196953, EL Loss: 0.0007408553501591086, Valid loss - 0.015768894040382203, AUC - 0.9737225365479593
EL Loss 0.0007408553501591086

Validation

Epoch 25: Loss - 0.00482956071077338, EL Loss: 0.0007332756649702787, Valid loss - 0.015893278356043646, AUC - 0.9733130215681665
EL Loss 0.0007332756649702787

Validation

Epoch 26: Loss - 0.004742823831210527, EL Loss: 0.0007258518016897142, Valid loss - 0.01606023610558039, AUC - 0.9730289876098445
EL Loss 0.0007258518016897142

Validation

Epoch 27: Loss - 0.00465547368813449, EL Loss: 0.0007186945294961333, Valid loss - 0.01616546236852437, AUC - 0.9727940862745935
EL Loss 0.0007186945294961333

Validation

Epoch 28: Loss - 0.004565810054621331, EL Loss: 0.0007114573963917792, Valid loss - 0.0162437063653344, AUC - 0.9722171967202737
EL Loss 0.0007114573963917792

Validation

Epoch 29: Loss - 0.004487807025229399, EL Loss: 0.0007046184618957341, Valid loss - 0.01635899898354654, AUC - 0.9721722021144048
EL Loss 0.0007046184618957341

Validation

Epoch 30: Loss - 0.004409218222215052, EL Loss: 0.0006977717857807875, Valid loss - 0.016501487416709648, AUC - 0.9715869637054696
EL Loss 0.0006977717857807875

Validation

Epoch 31: Loss - 0.004329616055077746, EL Loss: 0.0006910173106007278, Valid loss - 0.016661258575357038, AUC - 0.9717330408093502
EL Loss 0.0006910173106007278

Validation

Epoch 32: Loss - 0.004251964519756835, EL Loss: 0.0006842768634669483, Valid loss - 0.016767910049285416, AUC - 0.9713858087063718
EL Loss 0.0006842768634669483

Validation

Epoch 33: Loss - 0.004175425167804034, EL Loss: 0.0006775861256755888, Valid loss - 0.016898868973424404, AUC - 0.9710731276303006
EL Loss 0.0006775861256755888

Validation

Epoch 34: Loss - 0.004108780147692993, EL Loss: 0.0006710401503369212, Valid loss - 0.01710812461183027, AUC - 0.9703994986199721
EL Loss 0.0006710401503369212

Validation

Epoch 35: Loss - 0.0040335179394539655, EL Loss: 0.0006645006942562759, Valid loss - 0.017167425668441955, AUC - 0.9702104753909438
EL Loss 0.0006645006942562759

Validation

Epoch 36: Loss - 0.003964876645113691, EL Loss: 0.0006581211346201599, Valid loss - 0.017276958769394293, AUC - 0.969636073700968
EL Loss 0.0006581211346201599

Validation

Epoch 37: Loss - 0.0038926353192271727, EL Loss: 0.0006515905261039734, Valid loss - 0.01742879154137623, AUC - 0.9697163558598325
EL Loss 0.0006515905261039734

Validation

Epoch 38: Loss - 0.0038267094116070603, EL Loss: 0.0006452228408306837, Valid loss - 0.0175490040148114, AUC - 0.9694773236359391
EL Loss 0.0006452228408306837

Validation

Epoch 39: Loss - 0.003763661058573317, EL Loss: 0.0006389880436472595, Valid loss - 0.01774102297646028, AUC - 0.9691840281574547
EL Loss 0.0006389880436472595

Validation

Epoch 40: Loss - 0.003696322853515581, EL Loss: 0.0006327646551653743, Valid loss - 0.017777866787380643, AUC - 0.9688685954816179
EL Loss 0.0006327646551653743

Validation

Epoch 41: Loss - 0.0036244513815869473, EL Loss: 0.000626645574811846, Valid loss - 0.017896158011331233, AUC - 0.9687431162107275
EL Loss 0.000626645574811846

Validation

Epoch 42: Loss - 0.0035700357883880233, EL Loss: 0.0006205694517120719, Valid loss - 0.018001676445114023, AUC - 0.9685207848063478
EL Loss 0.0006205694517120719

Validation

Epoch 43: Loss - 0.003500972423518595, EL Loss: 0.0006145055522210896, Valid loss - 0.01813443277583078, AUC - 0.9679346468148329
EL Loss 0.0006145055522210896

Validation

Epoch 44: Loss - 0.0034509146238302824, EL Loss: 0.0006084940978325903, Valid loss - 0.01820966080520992, AUC - 0.9679973654402666
EL Loss 0.0006084940978325903

Validation

Epoch 45: Loss - 0.003387426824784515, EL Loss: 0.0006024814210832119, Valid loss - 0.01843546476950984, AUC - 0.9675550394105367
EL Loss 0.0006024814210832119

Validation

Epoch 46: Loss - 0.003325174520548237, EL Loss: 0.0005965781165286899, Valid loss - 0.018585095136069957, AUC - 0.9668202602510982
EL Loss 0.0005965781165286899

Validation

Epoch 47: Loss - 0.0032603938771816584, EL Loss: 0.0005906824953854084, Valid loss - 0.01872332640176202, AUC - 0.9668751813347276
EL Loss 0.0005906824953854084

Validation

Epoch 48: Loss - 0.0032191746425021188, EL Loss: 0.0005847411812283099, Valid loss - 0.01872806847785358, AUC - 0.9668195717070461
EL Loss 0.0005847411812283099

Validation

Epoch 49: Loss - 0.00315392405991588, EL Loss: 0.0005789145361632109, Valid loss - 0.018923330235720418, AUC - 0.9661860604246805
EL Loss 0.0005789145361632109

Validation

Epoch 50: Loss - 0.0031086339109937067, EL Loss: 0.000573218974750489, Valid loss - 0.019048001341245794, AUC - 0.9663813661263538
EL Loss 0.000573218974750489

Validation

Epoch 51: Loss - 0.003043147054995643, EL Loss: 0.0005675912252627313, Valid loss - 0.01921356871816111, AUC - 0.9656505203517132
EL Loss 0.0005675912252627313

Validation

Epoch 52: Loss - 0.0030050281295850505, EL Loss: 0.0005619755829684436, Valid loss - 0.01912733524991774, AUC - 0.965818821559934
EL Loss 0.0005619755829684436

Validation

Epoch 53: Loss - 0.0029476887883158106, EL Loss: 0.0005564378807321191, Valid loss - 0.019471949564270032, AUC - 0.9648769258021589
EL Loss 0.0005564378807321191

Validation

Epoch 54: Loss - 0.0028985337764672954, EL Loss: 0.0005509149632416666, Valid loss - 0.019575450787849634, AUC - 0.9647411808955815
EL Loss 0.0005509149632416666

Validation

Epoch 55: Loss - 0.002857157975830143, EL Loss: 0.0005454489728435874, Valid loss - 0.01973183302461733, AUC - 0.9644215120544245
EL Loss 0.0005454489728435874

Validation

Epoch 56: Loss - 0.002811404988609535, EL Loss: 0.0005399959627538919, Valid loss - 0.019834027004738648, AUC - 0.9640885917087272
EL Loss 0.0005399959627538919

Validation

Epoch 57: Loss - 0.0027579389787371674, EL Loss: 0.0005345810786820948, Valid loss - 0.019943938590586185, AUC - 0.9637506826882566
EL Loss 0.0005345810786820948

Validation

Epoch 58: Loss - 0.0027210185216972604, EL Loss: 0.0005292253918014467, Valid loss - 0.020036985350335823, AUC - 0.9640425523483067
EL Loss 0.0005292253918014467

Validation

Epoch 59: Loss - 0.0026759841320282167, EL Loss: 0.0005237365840002894, Valid loss - 0.020269185511602297, AUC - 0.9628152706651698
EL Loss 0.0005237365840002894

Validation

Epoch 60: Loss - 0.002628027000934129, EL Loss: 0.0005185411428101361, Valid loss - 0.02030991807717968, AUC - 0.962849948781814
EL Loss 0.0005185411428101361

Validation

Epoch 61: Loss - 0.0025825554538724564, EL Loss: 0.0005133425001986325, Valid loss - 0.020341409358805344, AUC - 0.9633934889833511
EL Loss 0.0005133425001986325

Validation

Epoch 62: Loss - 0.002538077966908697, EL Loss: 0.0005082808784209192, Valid loss - 0.020559083325443445, AUC - 0.96305016528251
EL Loss 0.0005082808784209192

Validation

Epoch 63: Loss - 0.0024998125835819255, EL Loss: 0.0005031989421695471, Valid loss - 0.020567787420234563, AUC - 0.9629622470809079
EL Loss 0.0005031989421695471

Validation

Epoch 64: Loss - 0.0024682427997917825, EL Loss: 0.0004981986130587757, Valid loss - 0.02086586054460502, AUC - 0.9620340070536698
EL Loss 0.0004981986130587757

Validation

Epoch 65: Loss - 0.0024246252680975226, EL Loss: 0.0004931173752993345, Valid loss - 0.021063357867576456, AUC - 0.9614425303244453
EL Loss 0.0004931173752993345

Validation

Epoch 66: Loss - 0.0023880211836678263, EL Loss: 0.0004881404747720808, Valid loss - 0.02106435849894712, AUC - 0.9614182879099087
EL Loss 0.0004881404747720808

Validation

Epoch 67: Loss - 0.002347487435310375, EL Loss: 0.00048315690946765244, Valid loss - 0.021255110378986523, AUC - 0.9613578368630878
EL Loss 0.00048315690946765244

Validation

Epoch 68: Loss - 0.0023160562570245184, EL Loss: 0.0004783532058354467, Valid loss - 0.021319276227811237, AUC - 0.9608023235220902
EL Loss 0.0004783532058354467

Validation

Epoch 69: Loss - 0.0022769256441031098, EL Loss: 0.000473542109830305, Valid loss - 0.021347646383039744, AUC - 0.9610659850556167
EL Loss 0.000473542109830305

Validation

Epoch 70: Loss - 0.002243659960434095, EL Loss: 0.0004687518812716007, Valid loss - 0.02159348163569783, AUC - 0.9603416433671174
EL Loss 0.0004687518812716007

Validation

Epoch 71: Loss - 0.002212006681061625, EL Loss: 0.00046403499436564744, Valid loss - 0.02173573234015041, AUC - 0.9604515189140438
EL Loss 0.00046403499436564744

Validation

Epoch 72: Loss - 0.00217429022830567, EL Loss: 0.00045948789920657873, Valid loss - 0.02185350986496534, AUC - 0.9597991574122048
EL Loss 0.00045948789920657873

Validation

Epoch 73: Loss - 0.0021403123855634476, EL Loss: 0.0004549936857074499, Valid loss - 0.02197481744727235, AUC - 0.9599266031009676
EL Loss 0.0004549936857074499

Validation

Epoch 74: Loss - 0.0021134789440524896, EL Loss: 0.00045042301644571126, Valid loss - 0.022109026652703315, AUC - 0.9593839016786043
EL Loss 0.00045042301644571126

Validation

Epoch 75: Loss - 0.002083152126612152, EL Loss: 0.0004459125630091876, Valid loss - 0.02228742253817158, AUC - 0.9593690141855495
EL Loss 0.0004459125630091876

Validation

Epoch 76: Loss - 0.0020519005305769415, EL Loss: 0.00044147297739982605, Valid loss - 0.022371335690956055, AUC - 0.9584465318932103
EL Loss 0.00044147297739982605

Validation

Epoch 77: Loss - 0.0020259480244352412, EL Loss: 0.0004371805116534233, Valid loss - 0.02258810177905324, AUC - 0.9581031749754413
EL Loss 0.0004371805116534233

Validation

Epoch 78: Loss - 0.001988418182877054, EL Loss: 0.000432925095083192, Valid loss - 0.022626162667609293, AUC - 0.9584374131784672
EL Loss 0.000432925095083192

Validation

Epoch 79: Loss - 0.001963267477135973, EL Loss: 0.00042874168138951063, Valid loss - 0.022714809790529585, AUC - 0.9581985893953673
EL Loss 0.00042874168138951063

Validation

Epoch 80: Loss - 0.0019338921908704585, EL Loss: 0.0004245800955686718, Valid loss - 0.022835647595333464, AUC - 0.9573027231652541
EL Loss 0.0004245800955686718

Validation

Epoch 81: Loss - 0.0019173093245295934, EL Loss: 0.0004205010482110083, Valid loss - 0.023023363961665717, AUC - 0.9574765070877133
EL Loss 0.0004205010482110083

Validation

Epoch 82: Loss - 0.001886668692846301, EL Loss: 0.00041645203600637615, Valid loss - 0.02300493520351104, AUC - 0.9572509824702731
EL Loss 0.00041645203600637615

Validation

Epoch 83: Loss - 0.0018621108067484536, EL Loss: 0.00041241690632887185, Valid loss - 0.023256486258756967, AUC - 0.9567858942554136
EL Loss 0.00041241690632887185

Validation

Epoch 84: Loss - 0.0018333472478595716, EL Loss: 0.0004083983367308974, Valid loss - 0.023335541770965966, AUC - 0.9569085650760072
EL Loss 0.0004083983367308974

Validation

Epoch 85: Loss - 0.0018011124991723839, EL Loss: 0.0004044142260681838, Valid loss - 0.023431015361882288, AUC - 0.9567797982310354
EL Loss 0.0004044142260681838

Validation

Epoch 86: Loss - 0.0017841108172185407, EL Loss: 0.0004004518559668213, Valid loss - 0.02354957134589369, AUC - 0.9568202976738326
EL Loss 0.0004004518559668213

Validation

Epoch 87: Loss - 0.001766704514879662, EL Loss: 0.00039654067950323224, Valid loss - 0.023566806447450763, AUC - 0.9565342810298607
EL Loss 0.00039654067950323224

Validation

Epoch 88: Loss - 0.0017458387633269012, EL Loss: 0.0003926756326109171, Valid loss - 0.023726885149508346, AUC - 0.9562576510870274
EL Loss 0.0003926756326109171

Validation

Epoch 89: Loss - 0.0017220659060099438, EL Loss: 0.00038881920045241714, Valid loss - 0.023777581084473632, AUC - 0.9559833469999653
EL Loss 0.00038881920045241714

Validation

Epoch 90: Loss - 0.001699547613125932, EL Loss: 0.0003850734792649746, Valid loss - 0.024029093679546573, AUC - 0.9554873118482451
EL Loss 0.0003850734792649746

Validation

Epoch 91: Loss - 0.0016749140432611139, EL Loss: 0.00038130395114421844, Valid loss - 0.02418583761440751, AUC - 0.9543959224642065
EL Loss 0.00038130395114421844

Validation

Epoch 92: Loss - 0.00164844334825499, EL Loss: 0.000377591815777123, Valid loss - 0.02424268599277661, AUC - 0.9549351401622623
EL Loss 0.000377591815777123

Validation

Epoch 93: Loss - 0.0016399629050945143, EL Loss: 0.0003739447856787592, Valid loss - 0.024240051499671407, AUC - 0.9554800797242798
EL Loss 0.0003739447856787592

Validation

Epoch 94: Loss - 0.0016119285647536426, EL Loss: 0.00037041923496872187, Valid loss - 0.024492928068395012, AUC - 0.9548984748717283
EL Loss 0.00037041923496872187

Validation

Epoch 95: Loss - 0.0015983670733393492, EL Loss: 0.00036697305040434003, Valid loss - 0.02462224438096638, AUC - 0.9544545619427511
EL Loss 0.00036697305040434003
Loading the best model


Valid Loss - 0.012434342427662125, Test Loss - 0.012107612095449282, Test AUC - 0.9811301855492399
/mnt/data1/xyliu/DeepgoSE/deepgo2/deepgo/data.py:23: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)
  data[i, :] = th.FloatTensor(row.mlp_activation[31])
/mnt/data1/xyliu/.conda/envs/xyliuEnv/lib/python3.8/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
enter load_data
features_length:  5120
features_column:  protgpt2
Terms 2829
data_root:  data
ont:  cc
terms_file:  data/cc/terms.pkl
features_length:  5120
features_column:  protgpt2
test_data_file:  test_gpt_data.pkl
DeepGOModel(
  (go_embed): Embedding(45250, 2560)
  (go_norm): BatchNorm1d(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (go_rad): Embedding(45250, 1)
  (rel_embed): Embedding(9, 2560)
  (net): Sequential(
    (0): MLPBlock(
      (linear): Linear(in_features=5120, out_features=2560, bias=True)
      (activation): ReLU()
      (layer_norm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (1): Residual(
      (fn): MLPBlock(
        (linear): Linear(in_features=2560, out_features=2560, bias=True)
        (activation): ReLU()
        (layer_norm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
Training the model

Validation

Epoch 0: Loss - 0.029675336221936795, EL Loss: 2.773848533630371, Valid loss - 0.024914424475512387, AUC - 0.8844321006645199
EL Loss 2.773848533630371
Saving model

Validation

Epoch 1: Loss - 0.01967753700790292, EL Loss: 1.0862467288970947, Valid loss - 0.013905114528757555, AUC - 0.9697281529374008
EL Loss 1.0862467288970947
Saving model

Validation

Epoch 2: Loss - 0.014825628738352943, EL Loss: 0.6028686165809631, Valid loss - 0.013556874046723047, AUC - 0.9730974921939194
EL Loss 0.6028686165809631
Saving model

Validation

Epoch 3: Loss - 0.014132316018565854, EL Loss: 0.35613441467285156, Valid loss - 0.013627638752905675, AUC - 0.9735787565894075
EL Loss 0.35613441467285156

Validation

Epoch 4: Loss - 0.014030036992732097, EL Loss: 0.20563369989395142, Valid loss - 0.013314143283131682, AUC - 0.9738938903052773
EL Loss 0.20563369989395142
Saving model

Validation

Epoch 5: Loss - 0.013746954864473082, EL Loss: 0.18122059106826782, Valid loss - 0.013265202178355352, AUC - 0.974793351680897
EL Loss 0.18122059106826782
Saving model

Validation

Epoch 6: Loss - 0.013615384777618932, EL Loss: 0.1622496396303177, Valid loss - 0.01323308226548963, AUC - 0.9753188853531901
EL Loss 0.1622496396303177
Saving model

Validation

Epoch 7: Loss - 0.013488068248658568, EL Loss: 0.13787899911403656, Valid loss - 0.01301341273902375, AUC - 0.9761789765277636
EL Loss 0.13787899911403656
Saving model

Validation

Epoch 8: Loss - 0.013131547064404003, EL Loss: 0.11050286889076233, Valid loss - 0.012708883111675581, AUC - 0.9780997132564353
EL Loss 0.11050286889076233
Saving model

Validation

Epoch 9: Loss - 0.012699040949717693, EL Loss: 0.08313582092523575, Valid loss - 0.01250494061106885, AUC - 0.9792820480358908
EL Loss 0.08313582092523575
Saving model

Validation

Epoch 10: Loss - 0.012268970765779324, EL Loss: 0.057226717472076416, Valid loss - 0.012248767988273391, AUC - 0.9805026087707507
EL Loss 0.057226717472076416
Saving model

Validation

Epoch 11: Loss - 0.011794059105754555, EL Loss: 0.03398791328072548, Valid loss - 0.012156426573149215, AUC - 0.9814475602502652
EL Loss 0.03398791328072548
Saving model

Validation

Epoch 12: Loss - 0.01126078383657097, EL Loss: 0.01415196992456913, Valid loss - 0.011941568627033704, AUC - 0.9828048712087566
EL Loss 0.01415196992456913
Saving model

Validation

Epoch 13: Loss - 0.010698703033664391, EL Loss: 0.0021897039841860533, Valid loss - 0.011770731183113876, AUC - 0.983372271799726
EL Loss 0.0021897039841860533
Saving model

Validation

Epoch 14: Loss - 0.010164546487596288, EL Loss: 0.001330980216152966, Valid loss - 0.01198888349312323, AUC - 0.9831838389362146
EL Loss 0.001330980216152966

Validation

Epoch 15: Loss - 0.009683603542229817, EL Loss: 0.0011822094675153494, Valid loss - 0.011925026486961194, AUC - 0.9836709528298888
EL Loss 0.0011822094675153494

Validation

Epoch 16: Loss - 0.009222217404550809, EL Loss: 0.0010552332969382405, Valid loss - 0.012115337242038898, AUC - 0.9828723431828386
EL Loss 0.0010552332969382405

Validation

Epoch 17: Loss - 0.008754193456049754, EL Loss: 0.0009477317798882723, Valid loss - 0.012323043838051367, AUC - 0.9830874386274872
EL Loss 0.0009477317798882723

Validation

Epoch 18: Loss - 0.008288689868508796, EL Loss: 0.0008508506580255926, Valid loss - 0.01249267675994355, AUC - 0.982266333031123
EL Loss 0.0008508506580255926

Validation

Epoch 19: Loss - 0.00781492257638919, EL Loss: 0.0007667469908483326, Valid loss - 0.012954406451755836, AUC - 0.9816695188554508
EL Loss 0.0007667469908483326

Validation

Epoch 20: Loss - 0.007003174327771624, EL Loss: 0.0007580294040963054, Valid loss - 0.012976724309501824, AUC - 0.9819018416733416
EL Loss 0.0007580294040963054

Validation

Epoch 21: Loss - 0.006838554673529209, EL Loss: 0.0007500969804823399, Valid loss - 0.0131437399275141, AUC - 0.9817844733210392
EL Loss 0.0007500969804823399

Validation

Epoch 22: Loss - 0.0067385973756741305, EL Loss: 0.0007422554190270603, Valid loss - 0.013250724711443907, AUC - 0.9814772608785131
EL Loss 0.0007422554190270603

Validation

Epoch 23: Loss - 0.0066477213817548045, EL Loss: 0.0007345308549702168, Valid loss - 0.013373229112246154, AUC - 0.9813908043951803
EL Loss 0.0007345308549702168

Validation

Epoch 24: Loss - 0.006558656368063318, EL Loss: 0.0007270266651175916, Valid loss - 0.01342030741090392, AUC - 0.9813299515041258
EL Loss 0.0007270266651175916

Validation

Epoch 25: Loss - 0.006480401193998246, EL Loss: 0.0007196989026851952, Valid loss - 0.013546752835405462, AUC - 0.9810812550184914
EL Loss 0.0007196989026851952

Validation

Epoch 26: Loss - 0.006401485842864283, EL Loss: 0.0007125630509108305, Valid loss - 0.013580765126755944, AUC - 0.9811443495868644
EL Loss 0.0007125630509108305

Validation

Epoch 27: Loss - 0.006324535681911088, EL Loss: 0.0007055888418108225, Valid loss - 0.013650357746231703, AUC - 0.9811198613700933
EL Loss 0.0007055888418108225

Validation

Epoch 28: Loss - 0.006242742239754245, EL Loss: 0.0006986336084082723, Valid loss - 0.01372077950724849, AUC - 0.9809751221160563
EL Loss 0.0006986336084082723

Validation

Epoch 29: Loss - 0.006155677053935837, EL Loss: 0.000691823719535023, Valid loss - 0.013812814126320091, AUC - 0.9808777670441913
EL Loss 0.000691823719535023

Validation

Epoch 30: Loss - 0.006084133953415651, EL Loss: 0.0006851041689515114, Valid loss - 0.013871105330317844, AUC - 0.980807272121188
EL Loss 0.0006851041689515114

Validation

Epoch 31: Loss - 0.006007567534404437, EL Loss: 0.0006782822893001139, Valid loss - 0.013977776994399818, AUC - 0.9807622085582526
EL Loss 0.0006782822893001139

Validation

Epoch 32: Loss - 0.005941191766065789, EL Loss: 0.0006715863128192723, Valid loss - 0.01397481727425331, AUC - 0.9808017863529398
EL Loss 0.0006715863128192723

Validation

Epoch 33: Loss - 0.005856306690640684, EL Loss: 0.0006648986600339413, Valid loss - 0.014028276316821575, AUC - 0.9807624117731587
EL Loss 0.0006648986600339413

Validation

Epoch 34: Loss - 0.005795200091101419, EL Loss: 0.0006583528593182564, Valid loss - 0.014064329158928659, AUC - 0.9808739656556225
EL Loss 0.0006583528593182564

Validation

Epoch 35: Loss - 0.005719407114983452, EL Loss: 0.0006519568269141018, Valid loss - 0.01412959893544515, AUC - 0.9806813577343805
EL Loss 0.0006519568269141018

Validation

Epoch 36: Loss - 0.005649901669874618, EL Loss: 0.0006456104456447065, Valid loss - 0.014186796766740305, AUC - 0.9805086423521695
EL Loss 0.0006456104456447065

Validation

Epoch 37: Loss - 0.005586070446290912, EL Loss: 0.0006392826908268034, Valid loss - 0.014254050754746537, AUC - 0.9804432672438899
EL Loss 0.0006392826908268034

Validation

Epoch 38: Loss - 0.00550260524026023, EL Loss: 0.0006330865435302258, Valid loss - 0.014410866930344959, AUC - 0.980167780448597
EL Loss 0.0006330865435302258

Validation

Epoch 39: Loss - 0.005437174627249161, EL Loss: 0.0006268723518587649, Valid loss - 0.01434782168103589, AUC - 0.9804116053080659
EL Loss 0.0006268723518587649

Validation

Epoch 40: Loss - 0.005374001524945594, EL Loss: 0.0006206528632901609, Valid loss - 0.01444630211012231, AUC - 0.9801133535534798
EL Loss 0.0006206528632901609

Validation

Epoch 41: Loss - 0.0053026037831758995, EL Loss: 0.000614443386439234, Valid loss - 0.014561414235719928, AUC - 0.9801166418317496
EL Loss 0.000614443386439234

Validation

Epoch 42: Loss - 0.0052304914282682476, EL Loss: 0.0006082942127250135, Valid loss - 0.014600303518459385, AUC - 0.9799768547351584
EL Loss 0.0006082942127250135

Validation

Epoch 43: Loss - 0.005170847005667218, EL Loss: 0.0006022570305503905, Valid loss - 0.014651824812186354, AUC - 0.9798080084179673
EL Loss 0.0006022570305503905

Validation

Epoch 44: Loss - 0.005099409701539447, EL Loss: 0.000596448895521462, Valid loss - 0.014696301650945787, AUC - 0.9797461952169735
EL Loss 0.000596448895521462

Validation

Epoch 45: Loss - 0.005037940683574892, EL Loss: 0.0005906130536459386, Valid loss - 0.014815289469688762, AUC - 0.9796726960143626
EL Loss 0.0005906130536459386

Validation

Epoch 46: Loss - 0.004976126314597257, EL Loss: 0.0005848969449289143, Valid loss - 0.014812900236359349, AUC - 0.9794083637711125
EL Loss 0.0005848969449289143

Validation

Epoch 47: Loss - 0.004909810871057826, EL Loss: 0.0005792996962554753, Valid loss - 0.014939238121848048, AUC - 0.9793628715318412
EL Loss 0.0005792996962554753

Validation

Epoch 48: Loss - 0.004843040789472236, EL Loss: 0.0005737923784181476, Valid loss - 0.014985683397102503, AUC - 0.9794411575509832
EL Loss 0.0005737923784181476

Validation

Epoch 49: Loss - 0.004775768226781193, EL Loss: 0.0005683331401087344, Valid loss - 0.015120039027138257, AUC - 0.9789928293164483
EL Loss 0.0005683331401087344

Validation

Epoch 50: Loss - 0.004722673462476285, EL Loss: 0.0005628974759019911, Valid loss - 0.015167310580979159, AUC - 0.9791545932809147
EL Loss 0.0005628974759019911

Validation

Epoch 51: Loss - 0.004657866365464129, EL Loss: 0.0005574829410761595, Valid loss - 0.015265527054851439, AUC - 0.9789211627073326
EL Loss 0.0005574829410761595

Validation

Epoch 52: Loss - 0.004587900125195368, EL Loss: 0.0005521415150724351, Valid loss - 0.015314344569672773, AUC - 0.9789162202533689
EL Loss 0.0005521415150724351

Validation

Epoch 53: Loss - 0.004535652261851778, EL Loss: 0.000546833558473736, Valid loss - 0.015408028457543733, AUC - 0.9786804993299346
EL Loss 0.000546833558473736

Validation

Epoch 54: Loss - 0.0044716751539950065, EL Loss: 0.0005415480700321496, Valid loss - 0.015451719685469144, AUC - 0.9786521939754499
EL Loss 0.0005415480700321496

Validation

Epoch 55: Loss - 0.004420408342081249, EL Loss: 0.0005362168303690851, Valid loss - 0.01554229341585327, AUC - 0.9784382766701836
EL Loss 0.0005362168303690851

Validation

Epoch 56: Loss - 0.004354813487556054, EL Loss: 0.0005309643456712365, Valid loss - 0.015618548027159255, AUC - 0.9784291337910365
EL Loss 0.0005309643456712365

Validation

Epoch 57: Loss - 0.004306041119806733, EL Loss: 0.0005257061566226184, Valid loss - 0.01570896124812188, AUC - 0.9784361931641564
EL Loss 0.0005257061566226184

Validation

Epoch 58: Loss - 0.004235789368315388, EL Loss: 0.0005204745684750378, Valid loss - 0.015783753476025147, AUC - 0.9782453621007167
EL Loss 0.0005204745684750378

Validation

Epoch 59: Loss - 0.004174542868647471, EL Loss: 0.0005152510711923242, Valid loss - 0.01585363673713104, AUC - 0.9779500775258961
EL Loss 0.0005152510711923242

Validation

Epoch 60: Loss - 0.004116310648896615, EL Loss: 0.0005101187853142619, Valid loss - 0.015968918190970096, AUC - 0.9780225490204447
EL Loss 0.0005101187853142619

Validation

Epoch 61: Loss - 0.00406010174463683, EL Loss: 0.0005050879553891718, Valid loss - 0.016039102855655882, AUC - 0.9776034909568253
EL Loss 0.0005050879553891718

Validation

Epoch 62: Loss - 0.004017348271604119, EL Loss: 0.0004997871583327651, Valid loss - 0.016133989517887432, AUC - 0.9776204951682723
EL Loss 0.0004997871583327651

Validation

Epoch 63: Loss - 0.003959711957412021, EL Loss: 0.0004948407295159996, Valid loss - 0.016252264978341115, AUC - 0.9773107191636091
EL Loss 0.0004948407295159996

Validation

Epoch 64: Loss - 0.0038924871546028457, EL Loss: 0.0004899672931060195, Valid loss - 0.01630172075956692, AUC - 0.9772896018476555
EL Loss 0.0004899672931060195

Validation

Epoch 65: Loss - 0.003847627096712875, EL Loss: 0.0004851095727644861, Valid loss - 0.01630780801039051, AUC - 0.9773200551070322
EL Loss 0.0004851095727644861

Validation

Epoch 66: Loss - 0.0037958898519718787, EL Loss: 0.0004802524344995618, Valid loss - 0.016509537102171668, AUC - 0.9768062763310661
EL Loss 0.0004802524344995618

Validation

Epoch 67: Loss - 0.0037471549348992994, EL Loss: 0.0004754080146085471, Valid loss - 0.01653848862114512, AUC - 0.9771008558704806
EL Loss 0.0004754080146085471

Validation

Epoch 68: Loss - 0.003688902002812194, EL Loss: 0.0004705596074927598, Valid loss - 0.01669169635868367, AUC - 0.9766707694274351
EL Loss 0.0004705596074927598

Validation

Epoch 69: Loss - 0.00364236383674407, EL Loss: 0.0004658056714106351, Valid loss - 0.01670667741815617, AUC - 0.976597338781889
EL Loss 0.0004658056714106351

Validation

Epoch 70: Loss - 0.0035933462615337867, EL Loss: 0.000461127667222172, Valid loss - 0.016811791244020432, AUC - 0.9763375344882177
EL Loss 0.000461127667222172

Validation

Epoch 71: Loss - 0.0035309788785194873, EL Loss: 0.000456519250292331, Valid loss - 0.01690108238224998, AUC - 0.9764837825391325
EL Loss 0.000456519250292331

Validation

Epoch 72: Loss - 0.0034874214435893173, EL Loss: 0.00045196700375527143, Valid loss - 0.01702510667849838, AUC - 0.9760519906911872
EL Loss 0.00045196700375527143

Validation

Epoch 73: Loss - 0.0034443271882661397, EL Loss: 0.0004475366440601647, Valid loss - 0.017091018550189924, AUC - 0.9762329522597176
EL Loss 0.0004475366440601647

Validation

Epoch 74: Loss - 0.0034023548570820076, EL Loss: 0.0004431505221873522, Valid loss - 0.017181443993324115, AUC - 0.9762061231178856
EL Loss 0.0004431505221873522

Validation

Epoch 75: Loss - 0.0033471704415536474, EL Loss: 0.0004387983353808522, Valid loss - 0.0172482939483023, AUC - 0.9759742303999116
EL Loss 0.0004387983353808522

Validation

Epoch 76: Loss - 0.003310492046611299, EL Loss: 0.0004344498738646507, Valid loss - 0.017350589799016346, AUC - 0.975831117680342
EL Loss 0.0004344498738646507

Validation

Epoch 77: Loss - 0.0032488882999049647, EL Loss: 0.0004301588924136013, Valid loss - 0.017480681144436936, AUC - 0.975655154059645
EL Loss 0.0004301588924136013

Validation

Epoch 78: Loss - 0.0032131330162883387, EL Loss: 0.00042600432061590254, Valid loss - 0.01751875109326692, AUC - 0.9756849726794751
EL Loss 0.00042600432061590254

Validation

Epoch 79: Loss - 0.0031749576049729844, EL Loss: 0.00042196305003017187, Valid loss - 0.017751285829293875, AUC - 0.9751555038946169
EL Loss 0.00042196305003017187

Validation

Epoch 80: Loss - 0.00313732969417205, EL Loss: 0.000417950504925102, Valid loss - 0.017731247504276258, AUC - 0.9753770270797029
EL Loss 0.000417950504925102

Validation

Epoch 81: Loss - 0.003087529879105039, EL Loss: 0.0004139590892009437, Valid loss - 0.0178590415528527, AUC - 0.9752238692717737
EL Loss 0.0004139590892009437

Validation

Epoch 82: Loss - 0.003048134663252065, EL Loss: 0.0004099842335563153, Valid loss - 0.017911980767952806, AUC - 0.9753311575180179
EL Loss 0.0004099842335563153

Validation

Epoch 83: Loss - 0.0030042684026987195, EL Loss: 0.0004060243081767112, Valid loss - 0.018017070080487082, AUC - 0.9749657413805477
EL Loss 0.0004060243081767112

Validation

Epoch 84: Loss - 0.0029635340241921685, EL Loss: 0.00040216156048700213, Valid loss - 0.018168476249240798, AUC - 0.9747786367637828
EL Loss 0.00040216156048700213

Validation

Epoch 85: Loss - 0.002927037269562954, EL Loss: 0.00039832753827795386, Valid loss - 0.01817930373650642, AUC - 0.9747621253370383
EL Loss 0.00039832753827795386

Validation

Epoch 86: Loss - 0.0028868051349490997, EL Loss: 0.00039464631117880344, Valid loss - 0.018372581719800277, AUC - 0.9744653265447762
EL Loss 0.00039464631117880344

Validation

Epoch 87: Loss - 0.0028464764208448205, EL Loss: 0.0003907144127879292, Valid loss - 0.01837751089974686, AUC - 0.9744140613416188
EL Loss 0.0003907144127879292

Validation

Epoch 88: Loss - 0.002809141329469805, EL Loss: 0.0003869069623760879, Valid loss - 0.018593314379729605, AUC - 0.9742669210207169
EL Loss 0.0003869069623760879

Validation

Epoch 89: Loss - 0.0027830333766277445, EL Loss: 0.0003831994254142046, Valid loss - 0.01861400271041526, AUC - 0.9739897920437147
EL Loss 0.0003831994254142046

Validation

Epoch 90: Loss - 0.002735453279538805, EL Loss: 0.00037952931597828865, Valid loss - 0.018805940474533003, AUC - 0.9739634261883101
EL Loss 0.00037952931597828865

Validation

Epoch 91: Loss - 0.0026966771263025953, EL Loss: 0.00037590297870337963, Valid loss - 0.018825169342259567, AUC - 0.9735454453174599
EL Loss 0.00037590297870337963

Validation

Epoch 92: Loss - 0.0026681295385060366, EL Loss: 0.00037222146056592464, Valid loss - 0.018985382396221898, AUC - 0.9734100475673358
EL Loss 0.00037222146056592464

Validation

Epoch 93: Loss - 0.002638873659055786, EL Loss: 0.00036865202127955854, Valid loss - 0.018898667963106693, AUC - 0.9733615012032917
EL Loss 0.00036865202127955854

Validation

Epoch 94: Loss - 0.0026036281975724373, EL Loss: 0.00036511634243652225, Valid loss - 0.018993057977454163, AUC - 0.9731401692284783
EL Loss 0.00036511634243652225

Validation

Epoch 95: Loss - 0.0025651807236499735, EL Loss: 0.0003616608737502247, Valid loss - 0.019165759779696846, AUC - 0.9734483642274656
EL Loss 0.0003616608737502247
Loading the best model


Valid Loss - 0.011770731183113876, Test Loss - 0.011288263551566912, Test AUC - 0.9848690837910887
/mnt/data1/xyliu/DeepgoSE/deepgo2/deepgo/data.py:23: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)
  data[i, :] = th.FloatTensor(row.mlp_activation[24])
/mnt/data1/xyliu/.conda/envs/xyliuEnv/lib/python3.8/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
enter load_data
features_length:  5120
features_column:  protgpt2
Terms 2829
data_root:  data
ont:  cc
terms_file:  data/cc/terms.pkl
features_length:  5120
features_column:  protgpt2
test_data_file:  test_gpt_data.pkl
DeepGOModel(
  (go_embed): Embedding(45250, 2560)
  (go_norm): BatchNorm1d(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (go_rad): Embedding(45250, 1)
  (rel_embed): Embedding(9, 2560)
  (net): Sequential(
    (0): MLPBlock(
      (linear): Linear(in_features=5120, out_features=2560, bias=True)
      (activation): ReLU()
      (layer_norm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (1): Residual(
      (fn): MLPBlock(
        (linear): Linear(in_features=2560, out_features=2560, bias=True)
        (activation): ReLU()
        (layer_norm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
)
Training the model

Validation

Epoch 0: Loss - 0.029598547886549073, EL Loss: 2.791011333465576, Valid loss - 0.025483278258715148, AUC - 0.8732229622860463
EL Loss 2.791011333465576
Saving model

Validation

Epoch 1: Loss - 0.019274473056033126, EL Loss: 1.0936551094055176, Valid loss - 0.013710255033256095, AUC - 0.9696345949590226
EL Loss 1.0936551094055176
Saving model

Validation

Epoch 2: Loss - 0.01491999992206481, EL Loss: 0.6162126064300537, Valid loss - 0.013431651494753213, AUC - 0.9732897251030258
EL Loss 0.6162126064300537
Saving model

Validation

Epoch 3: Loss - 0.014240004554845986, EL Loss: 0.3643782436847687, Valid loss - 0.01331085622034691, AUC - 0.9738006380017353
EL Loss 0.3643782436847687
Saving model

Validation

Epoch 4: Loss - 0.014023458258386447, EL Loss: 0.20509088039398193, Valid loss - 0.0132074331358811, AUC - 0.9742612447129225
EL Loss 0.20509088039398193
Saving model

Validation

Epoch 5: Loss - 0.013701875732460228, EL Loss: 0.18020978569984436, Valid loss - 0.013182623725798395, AUC - 0.9748217884217206
EL Loss 0.18020978569984436
Saving model

Validation

Epoch 6: Loss - 0.013592871945134406, EL Loss: 0.16072800755500793, Valid loss - 0.01314728889890291, AUC - 0.9751320042358638
EL Loss 0.16072800755500793
Saving model

Validation

Epoch 7: Loss - 0.013471272438685199, EL Loss: 0.13605813682079315, Valid loss - 0.013004059604380601, AUC - 0.9756769456305917
EL Loss 0.13605813682079315
Saving model

Validation

Epoch 8: Loss - 0.013250040591215524, EL Loss: 0.10845211893320084, Valid loss - 0.012751683167377372, AUC - 0.9768350868596816
EL Loss 0.10845211893320084
Saving model

Validation

Epoch 9: Loss - 0.01271968731651379, EL Loss: 0.08092571049928665, Valid loss - 0.012567263740448304, AUC - 0.979142885228975
EL Loss 0.08092571049928665
Saving model

Validation

Epoch 10: Loss - 0.012265978200792399, EL Loss: 0.055205926299095154, Valid loss - 0.01236873798440268, AUC - 0.980087807007932
EL Loss 0.055205926299095154
Saving model

Validation

Epoch 11: Loss - 0.011818944620079657, EL Loss: 0.03224499896168709, Valid loss - 0.012164036846823163, AUC - 0.9813574097660795
EL Loss 0.03224499896168709
Saving model

Validation

Epoch 12: Loss - 0.01135710649329915, EL Loss: 0.012820308096706867, Valid loss - 0.011980872934707154, AUC - 0.982430227916349
EL Loss 0.012820308096706867
Saving model

Validation

Epoch 13: Loss - 0.010823048582427542, EL Loss: 0.0018357260851189494, Valid loss - 0.011965933336335936, AUC - 0.9827460599877371
EL Loss 0.0018357260851189494
Saving model

Validation

Epoch 14: Loss - 0.01034110704131308, EL Loss: 0.0013797514839097857, Valid loss - 0.011882604835669936, AUC - 0.9831951054341757
EL Loss 0.0013797514839097857
Saving model

Validation

Epoch 15: Loss - 0.009899293154541572, EL Loss: 0.0012259744107723236, Valid loss - 0.01182211437665018, AUC - 0.9833370646989228
EL Loss 0.0012259744107723236
Saving model

Validation

Epoch 16: Loss - 0.009472393593155588, EL Loss: 0.0010935895843431354, Valid loss - 0.011907962967216232, AUC - 0.9833983015040655
EL Loss 0.0010935895843431354

Validation

Epoch 17: Loss - 0.009070266378826504, EL Loss: 0.000979023752734065, Valid loss - 0.012256273206461358, AUC - 0.9828046681307326
EL Loss 0.000979023752734065

Validation

Epoch 18: Loss - 0.008652163789520273, EL Loss: 0.0008810364524833858, Valid loss - 0.01220006434775797, AUC - 0.9827166876519507
EL Loss 0.0008810364524833858

Validation

Epoch 19: Loss - 0.00824428963063507, EL Loss: 0.0007923953817225993, Valid loss - 0.012355225816093109, AUC - 0.98244745210478
EL Loss 0.0007923953817225993

Validation

Epoch 20: Loss - 0.007578026314811062, EL Loss: 0.0007835207507014275, Valid loss - 0.012537014716661271, AUC - 0.9821289787886605
EL Loss 0.0007835207507014275

Validation

Epoch 21: Loss - 0.007466431701521453, EL Loss: 0.0007753251120448112, Valid loss - 0.01258603532879073, AUC - 0.9819886562759325
EL Loss 0.0007753251120448112

Validation

Epoch 22: Loss - 0.0073983969404335685, EL Loss: 0.0007671908242627978, Valid loss - 0.012638302945336442, AUC - 0.9817976668875877
EL Loss 0.0007671908242627978

Validation

Epoch 23: Loss - 0.0073297109867615454, EL Loss: 0.0007593213813379407, Valid loss - 0.012693712280856239, AUC - 0.9817061910920349
EL Loss 0.0007593213813379407

Validation

Epoch 24: Loss - 0.007256576236448547, EL Loss: 0.0007516887271776795, Valid loss - 0.012732469718213435, AUC - 0.9814841774964059
EL Loss 0.0007516887271776795

Validation

Epoch 25: Loss - 0.007197333438605049, EL Loss: 0.000744127668440342, Valid loss - 0.012818552197221621, AUC - 0.9814147271971546
EL Loss 0.000744127668440342

Validation

Epoch 26: Loss - 0.007129113751447717, EL Loss: 0.0007366181234829128, Valid loss - 0.012846661881072285, AUC - 0.9813064347243585
EL Loss 0.0007366181234829128

Validation

Epoch 27: Loss - 0.007067047222583576, EL Loss: 0.0007291293004527688, Valid loss - 0.012913007335162457, AUC - 0.9811540015899752
EL Loss 0.0007291293004527688

Validation

Epoch 28: Loss - 0.007003323053306138, EL Loss: 0.0007217550883069634, Valid loss - 0.012968224657262549, AUC - 0.9812157256086861
EL Loss 0.0007217550883069634

Validation

Epoch 29: Loss - 0.006944292617845349, EL Loss: 0.0007145160343497992, Valid loss - 0.013038103963121956, AUC - 0.9808500606910163
EL Loss 0.0007145160343497992

Validation

Epoch 30: Loss - 0.006882106594606408, EL Loss: 0.0007074049790389836, Valid loss - 0.013074027052448119, AUC - 0.981033006773346
EL Loss 0.0007074049790389836

Validation

Epoch 31: Loss - 0.006819236213314897, EL Loss: 0.0007002959609963, Valid loss - 0.013163260816607946, AUC - 0.9808567636939396
EL Loss 0.0007002959609963

Validation

Epoch 32: Loss - 0.006760878754324618, EL Loss: 0.0006933518452569842, Valid loss - 0.013164416369464662, AUC - 0.98070703424877
EL Loss 0.0006933518452569842

Validation

Epoch 33: Loss - 0.006696742697551434, EL Loss: 0.0006864548195153475, Valid loss - 0.013285993460427832, AUC - 0.9806122888838049
EL Loss 0.0006864548195153475

Validation

Epoch 34: Loss - 0.006625288762899634, EL Loss: 0.0006795677472837269, Valid loss - 0.013326609242753482, AUC - 0.9805289014394037
EL Loss 0.0006795677472837269

Validation

Epoch 35: Loss - 0.006573688245142958, EL Loss: 0.0006727619329467416, Valid loss - 0.013409723539227321, AUC - 0.9804697481022642
EL Loss 0.0006727619329467416

Validation

Epoch 36: Loss - 0.006503523548334752, EL Loss: 0.0006660180515609682, Valid loss - 0.013463511189192902, AUC - 0.9804820716605568
EL Loss 0.0006660180515609682

Validation

Epoch 37: Loss - 0.006444653926419877, EL Loss: 0.0006592700956389308, Valid loss - 0.013579775096365699, AUC - 0.9801360172589333
EL Loss 0.0006592700956389308

Validation

Epoch 38: Loss - 0.006371559747673349, EL Loss: 0.0006526483339257538, Valid loss - 0.013589526699097068, AUC - 0.9802024175703177
EL Loss 0.0006526483339257538

Validation

Epoch 39: Loss - 0.00631106906505672, EL Loss: 0.0006460484582930803, Valid loss - 0.013688353062779815, AUC - 0.9800062700993394
EL Loss 0.0006460484582930803

Validation

Epoch 40: Loss - 0.006252060496494364, EL Loss: 0.0006396028329618275, Valid loss - 0.01374527109487925, AUC - 0.9800384548519847
EL Loss 0.0006396028329618275

Validation

Epoch 41: Loss - 0.006194708831819959, EL Loss: 0.0006332097109407187, Valid loss - 0.013857582561027856, AUC - 0.9797803559997171
EL Loss 0.0006332097109407187

Validation

Epoch 42: Loss - 0.006121058254806981, EL Loss: 0.0006269305013120174, Valid loss - 0.01391280905837998, AUC - 0.979663704086691
EL Loss 0.0006269305013120174

Validation

Epoch 43: Loss - 0.006056234784409753, EL Loss: 0.0006206731777638197, Valid loss - 0.013992153234595869, AUC - 0.9795521729967589
EL Loss 0.0006206731777638197

Validation

Epoch 44: Loss - 0.005997821907426855, EL Loss: 0.0006144287181086838, Valid loss - 0.014046433646185899, AUC - 0.9793902740215984
EL Loss 0.0006144287181086838

Validation

Epoch 45: Loss - 0.005929404005159581, EL Loss: 0.0006081956089474261, Valid loss - 0.014125165966465885, AUC - 0.979493715291166
EL Loss 0.0006081956089474261

Validation

Epoch 46: Loss - 0.00586588376559534, EL Loss: 0.0006019360153004527, Valid loss - 0.014186886277187753, AUC - 0.9793298657278855
EL Loss 0.0006019360153004527

Validation

Epoch 47: Loss - 0.005801367383603726, EL Loss: 0.000595731835346669, Valid loss - 0.01431424941085739, AUC - 0.9791606135922913
EL Loss 0.000595731835346669

Validation

Epoch 48: Loss - 0.005743043296619858, EL Loss: 0.0005895657814107835, Valid loss - 0.014347353467234859, AUC - 0.979378338483883
EL Loss 0.0005895657814107835

Validation

Epoch 49: Loss - 0.005676130202449382, EL Loss: 0.0005835402989760041, Valid loss - 0.014439091500308778, AUC - 0.9790284268484898
EL Loss 0.0005835402989760041

Validation

Epoch 50: Loss - 0.005613871069230795, EL Loss: 0.0005776209873147309, Valid loss - 0.01458997484066604, AUC - 0.9789018720776148
EL Loss 0.0005776209873147309

Validation

Epoch 51: Loss - 0.005544410644936513, EL Loss: 0.0005719149485230446, Valid loss - 0.014654540111897168, AUC - 0.9787590028636878
EL Loss 0.0005719149485230446

Validation

Epoch 52: Loss - 0.005486802704994757, EL Loss: 0.0005662248586304486, Valid loss - 0.014715292238066962, AUC - 0.9786865065203206
EL Loss 0.0005662248586304486

Validation

Epoch 53: Loss - 0.005418361916533534, EL Loss: 0.0005605314509011805, Valid loss - 0.014837933715754821, AUC - 0.9786284959580946
EL Loss 0.0005605314509011805

Validation

Epoch 54: Loss - 0.00535919633313659, EL Loss: 0.000554997066501528, Valid loss - 0.014994639903306961, AUC - 0.9781731255033934
EL Loss 0.000554997066501528

Validation

Epoch 55: Loss - 0.005304224982451574, EL Loss: 0.0005494052893482149, Valid loss - 0.014978400650031773, AUC - 0.9783593118941221
EL Loss 0.0005494052893482149

Validation

Epoch 56: Loss - 0.005232142113196791, EL Loss: 0.0005438436637632549, Valid loss - 0.015186773820055855, AUC - 0.9781449856799381
EL Loss 0.0005438436637632549

Validation

Epoch 57: Loss - 0.005173882696412461, EL Loss: 0.0005383659736253321, Valid loss - 0.015210963682168059, AUC - 0.9779907183155487
EL Loss 0.0005383659736253321

Validation

Epoch 58: Loss - 0.005113933728353004, EL Loss: 0.0005328964325599372, Valid loss - 0.015250263022787777, AUC - 0.9783311470575902
EL Loss 0.0005328964325599372

Validation

Epoch 59: Loss - 0.00505246677791795, EL Loss: 0.0005275040748529136, Valid loss - 0.015308099844849404, AUC - 0.977868314372601
EL Loss 0.0005275040748529136

Validation

Epoch 60: Loss - 0.004992566848489911, EL Loss: 0.000522121146786958, Valid loss - 0.015368061404629254, AUC - 0.9779111196193363
EL Loss 0.000522121146786958

Validation

Epoch 61: Loss - 0.004932273309102377, EL Loss: 0.000516805739607662, Valid loss - 0.015496696713438004, AUC - 0.9775795225287217
EL Loss 0.000516805739607662

Validation

Epoch 62: Loss - 0.0048793489960106936, EL Loss: 0.0005114232772029936, Valid loss - 0.01560815173074787, AUC - 0.9773479368498501
EL Loss 0.0005114232772029936

Validation

Epoch 63: Loss - 0.004820321377006952, EL Loss: 0.0005060490220785141, Valid loss - 0.015623550137711896, AUC - 0.977692888861594
EL Loss 0.0005060490220785141

Validation

Epoch 64: Loss - 0.0047502881263261024, EL Loss: 0.0005007127765566111, Valid loss - 0.01567174368940386, AUC - 0.9772919333551691
EL Loss 0.0005007127765566111

Validation

Epoch 65: Loss - 0.004702015205442545, EL Loss: 0.0004954232717864215, Valid loss - 0.01576205775325681, AUC - 0.9774491642704067
EL Loss 0.0004954232717864215

Validation

Epoch 66: Loss - 0.004637170220038653, EL Loss: 0.0004901343490928411, Valid loss - 0.01592709950780795, AUC - 0.9769901016962325
EL Loss 0.0004901343490928411

Validation

Epoch 67: Loss - 0.0045890157390121285, EL Loss: 0.0004850436234846711, Valid loss - 0.01587447021616462, AUC - 0.9770239991542036
EL Loss 0.0004850436234846711

Validation

Epoch 68: Loss - 0.0045217368979964786, EL Loss: 0.00047994081978686154, Valid loss - 0.016058702815186093, AUC - 0.9767372939661803
EL Loss 0.00047994081978686154

Validation

Epoch 69: Loss - 0.004480248601215531, EL Loss: 0.0004748485516756773, Valid loss - 0.016140996110568077, AUC - 0.9766383309150938
EL Loss 0.0004748485516756773

Validation

Epoch 70: Loss - 0.004426287851939295, EL Loss: 0.00046981486957520247, Valid loss - 0.016146674154349314, AUC - 0.976571406013493
EL Loss 0.00046981486957520247

Validation

Epoch 71: Loss - 0.004373901321741869, EL Loss: 0.00046477391151711345, Valid loss - 0.016175920488657774, AUC - 0.976659832671375
EL Loss 0.00046477391151711345

Validation

Epoch 72: Loss - 0.004308627878675576, EL Loss: 0.00045997678535059094, Valid loss - 0.01623038817656997, AUC - 0.9765952491997796
EL Loss 0.00045997678535059094

Validation

Epoch 73: Loss - 0.004252406284814986, EL Loss: 0.00045527846668846905, Valid loss - 0.016335108869329647, AUC - 0.9762610489756879
EL Loss 0.00045527846668846905

Validation

Epoch 74: Loss - 0.0042115233367936026, EL Loss: 0.0004507404810283333, Valid loss - 0.016499275261145314, AUC - 0.9760855403098098
EL Loss 0.0004507404810283333

Validation

Epoch 75: Loss - 0.004158447821530651, EL Loss: 0.00044631847413256764, Valid loss - 0.016576941516020415, AUC - 0.9757411275606148
EL Loss 0.00044631847413256764

Validation

Epoch 76: Loss - 0.004100594278001649, EL Loss: 0.00044192964560352266, Valid loss - 0.01673075847649648, AUC - 0.9754449129786983
EL Loss 0.00044192964560352266

Validation

Epoch 77: Loss - 0.004053865104982502, EL Loss: 0.00043751983321271837, Valid loss - 0.016559743632872898, AUC - 0.9760032444856408
EL Loss 0.00043751983321271837

Validation

Epoch 78: Loss - 0.004000987887180104, EL Loss: 0.00043315679067745805, Valid loss - 0.016710803441611338, AUC - 0.9757150786379085
EL Loss 0.00043315679067745805

Validation

Epoch 79: Loss - 0.003950874289082342, EL Loss: 0.00042889188625849783, Valid loss - 0.01700660503572888, AUC - 0.975105568647722
EL Loss 0.00042889188625849783

Validation

Epoch 80: Loss - 0.0039037244101895008, EL Loss: 0.00042473661596886814, Valid loss - 0.017081902776327398, AUC - 0.9749235353298004
EL Loss 0.00042473661596886814

Validation

Epoch 81: Loss - 0.003852010669189357, EL Loss: 0.0004206866433378309, Valid loss - 0.01698058345757517, AUC - 0.9752971026659469
EL Loss 0.0004206866433378309

Validation

Epoch 82: Loss - 0.0038089591424233567, EL Loss: 0.0004166611470282078, Valid loss - 0.017107603347135916, AUC - 0.97522225569556
EL Loss 0.0004166611470282078

Validation

Epoch 83: Loss - 0.0037553315548641626, EL Loss: 0.0004127969441469759, Valid loss - 0.017242222679434, AUC - 0.9747801533858026
EL Loss 0.0004127969441469759

Validation

Epoch 84: Loss - 0.003711180126463825, EL Loss: 0.0004089499998372048, Valid loss - 0.017212923041280404, AUC - 0.9750384515396455
EL Loss 0.0004089499998372048

Validation

Epoch 85: Loss - 0.0036626008016107585, EL Loss: 0.0004051826836075634, Valid loss - 0.017412146771855562, AUC - 0.97465254941168
EL Loss 0.0004051826836075634

Validation

Epoch 86: Loss - 0.0036320849000979, EL Loss: 0.0004014127771370113, Valid loss - 0.017513941007631796, AUC - 0.9742114993500559
EL Loss 0.0004014127771370113

Validation

Epoch 87: Loss - 0.003576966475851474, EL Loss: 0.00039763329550623894, Valid loss - 0.01743010835101207, AUC - 0.9745206233264746
EL Loss 0.00039763329550623894

Validation

Epoch 88: Loss - 0.0035260951462160765, EL Loss: 0.00039390791789628565, Valid loss - 0.017649976272181966, AUC - 0.9741261893359537
EL Loss 0.00039390791789628565

Validation

Epoch 89: Loss - 0.003482114211196445, EL Loss: 0.0003901273594237864, Valid loss - 0.01760619142909109, AUC - 0.9741050515909798
EL Loss 0.0003901273594237864

Validation

Epoch 90: Loss - 0.003443778267286358, EL Loss: 0.00038634162046946585, Valid loss - 0.017693805703778327, AUC - 0.9741448827772998
EL Loss 0.00038634162046946585

Validation

Epoch 91: Loss - 0.0034000638037964977, EL Loss: 0.0003825882449746132, Valid loss - 0.01792973542103061, AUC - 0.9734752149466135
EL Loss 0.0003825882449746132

Validation

Epoch 92: Loss - 0.0033566842737193588, EL Loss: 0.00037916653673164546, Valid loss - 0.017967083169446316, AUC - 0.9735175402482653
EL Loss 0.00037916653673164546

Validation

Epoch 93: Loss - 0.0033190341201506353, EL Loss: 0.00037515570875257254, Valid loss - 0.018025344433147968, AUC - 0.9732376178993839
EL Loss 0.00037515570875257254

Validation

Epoch 94: Loss - 0.003267496079553728, EL Loss: 0.0003714524791575968, Valid loss - 0.0181168283186393, AUC - 0.9732238235642147
EL Loss 0.0003714524791575968

Validation

Epoch 95: Loss - 0.0032347668523222887, EL Loss: 0.0003678720095194876, Valid loss - 0.0181097487953526, AUC - 0.9737191634448465
EL Loss 0.0003678720095194876
Loading the best model


Valid Loss - 0.01182211437665018, Test Loss - 0.011500099613128797, Test AUC - 0.9843342320032468
/mnt/data1/xyliu/DeepgoSE/deepgo2/deepgo/data.py:23: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)
  data[i, :] = th.FloatTensor(row.mlp_activation[25])
/mnt/data1/xyliu/.conda/envs/xyliuEnv/lib/python3.8/site-packages/transformers/utils/generic.py:441: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
